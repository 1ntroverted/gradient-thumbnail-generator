<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>스토리 그라데이션 썸네일 생성기</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Sniglet:wght@400;">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:wght=400;">
  <style>
    body {
      background:#000000;
      color:#eee;
      font-family: Inter;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:12px;
      padding:20px;
    }
    textarea {
      text-align: center;
      background:#000;
      color:#ffffff;
      resize:none;
      font-family: Inter;
    }
    #asciiInput {
      width:400px;
      height:30px;
      border:1px solid #444;
      padding:10px;
      font-size: 25px;
    }
    #fontsize_text {
      width:50px;
      height:21px;
      border-style: none;
      font-size: 16px;
    }
    button {
      padding:8px 16px;
      background:#222;
      color:#fff;
      border:1px solid #555;
      cursor:pointer;
    }
    button:hover { background:#333; }
    canvas {
      border:1px solid #555;
      background:#000;
    }
    div {
      display: flex;
      justify-content: center; /* 가로 중앙 */
      align-items: center;  /* 세로 중앙 */
      gap: 5px;
    }
  </style>
</head>
<body>
  <h2>Story Gradation Thumbnail</h2>
  <textarea id="asciiInput"></textarea>

  <div>
    <button onclick="downloadImage()">다운로드</button>
  </div>
  <div>
    배경 색: <input type="color" value="#000000" id="colorbg"> |
    색 1: <input type="color" value="#FF0000" id="color1"> |
    색 2: <input type="color" value="#FFFF00" id="color2">
  </div>
    폰트 사이즈 조절
    <div>
      <input type="range" value="200" max="300" min="50" id="font_size"> <textarea id="fontsize_text">200</textarea>px
    </div>
  <div>
    <button onclick="ChangeSize(125)">125px</button>
    <button onclick="ChangeSize(150)">150px</button>
    <button onclick="ChangeSize(175)">175px</button>
    <button onclick="ChangeSize(200)">200px</button>
    <button onclick="ChangeSize(225)">225px</button>
    <button onclick="ChangeSize(250)">250px</button>
  </div>
  <canvas id="canvas" width="1280" height="720"></canvas>

  <script>
    // 내일 날짜 구하기
    date = new Date();
    date.setDate(date.getDate() + 1)
    year = date.getFullYear();
    month = String(date.getMonth() + 1).padStart(2, '0');
    day = String(date.getDate()).padStart(2, '0');
    function getToday() {
      document.getElementById('asciiInput').value = year + "." + month + "." + day + ".";
    }
    window.onload = function () {
      getToday();
    };

    const colorPicker = document.getElementById('colorbg');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const colorone = document.getElementById('color1');
    const colortwo = document.getElementById('color2');
    const fontsize = document.getElementById('font_size');
    const fontsizetext = document.getElementById('fontsize_text');
    const sizeinput = document.getElementById('fontsizeinput');

    function renderArt() {
      // 배경
      ctx.fillStyle = colorPicker.value;
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // 텍스트
      const text = document.getElementById('asciiInput').value;
      const grad = ctx.createLinearGradient(0, 360-fontsize.value/200*60, 0, 360+fontsize.value/200*60);
      grad.addColorStop(0, colorone.value);
      grad.addColorStop(1, colortwo.value);
      ctx.fillStyle = grad;
      if(fontsizetext.value != fontsize.value)
        fontsizetext.value = fontsize.value;
      ctx.font = fontsize.value + 'px Sniglet';
      ctx.textAlign = 'center'
      ctx.textBaseline = 'middle';

      const lines = text.split('\n');
      const lineHeight = 28;
      let y = 40;

      for (let line of lines) {
        ctx.fillText(line, canvas.width / 2, canvas.height / 2);
        y += lineHeight;
      }
    }

    function ChangeSize(value) {
      fontsize.value = value;
      fontsizetext.value = fontsize.value;
    }

    // 다운로드
    function downloadImage() {
      const link = document.createElement('a');
      link.download = month + day + '.png';
      link.href = canvas.toDataURL('image/png');
      link.click();
    }
    
    // 미리 보기
    const timer = setInterval(() => {
      renderArt();
    },50)
  </script>
</body>
</html>
